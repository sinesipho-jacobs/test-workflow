# .github/workflows/test-results.yaml
name: Display Test Results

on:
  workflow_call:
    inputs:
      output_file:
        required: true
        type: string
      markdown_file:
        required: true
        type: string

jobs:
  parse-results:
    runs-on: ubuntu-latest
    steps:
      - name: 📥 Download Test Results
        uses: actions/download-artifact@v4
        with:
          name: robot-test-results
          path: webapp_tests/robot-test-results

      - name: 🏗 Set Up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: 📜 Install Robot Framework
        run: pip install robotframework

      - name: 📊 Parse Robot Test Results
        run: python functions/display_test_results.py webapp_tests/robot-test-results/output.xml report.md

      - name: 📝 Display Test Summary in GitHub Actions UI
        run: cat report.md >> $GITHUB_STEP_SUMMARY
        
